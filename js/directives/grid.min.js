(function(k,e){var h=k.module("ngfur.grid.directives",[]);h.directive("furGridHeaderCell",["$compile","$templateCache",function(c,e){return{restrict:"A",scope:!1,replace:!0,compile:function(){return{pre:function(a,f,g){a.columndef[a.$index].hasOwnProperty("headerTemplate")?f.append(c(a.columndef[a.$index].headerTemplate)(a)):f.append(c("<span>{{col.value}}</span>")(a))}}}}}]);h.directive("furGridHeader",["$compile","$templateCache",function(c,e){return{restrict:"A",scope:!1,compile:function(){return{pre:function(a,
f,g){g=e.get("ng-fur-grid-header.html");f.append(c(g)(a))}}}}}]);h.directive("furGridRowCell",["$compile","$templateCache",function(c,h){return{restrict:"A",scope:!1,replace:!0,compile:function(){return{pre:function(a,f,g){a.columndef[a.$index].hasOwnProperty("template")?f.append(c(a.columndef[a.$index].template)(a)):f.append(c("<span>{{row[col.value]}}</span>")(a));e(f).on("dblclick",function(c){a.onDoubleClick({evt:a.$parent.row})});e(f).on("click",function(c){a.onClick({evt:a.$parent.row})})}}}}}]);
h.directive("furGridRows",["$compile","$templateCache",function(c,e){return{restrict:"A",scope:!1,compile:function(){return{pre:function(a,f,g){g=e.get("ng-fur-grid-row.html");f.append(c(g)(a))}}}}}]);h.directive("grid",["$compile","$templateCache",function(c,h){return{restrict:"E",scope:{columns:"=",dataprovider:"=",sortFunction:"@",onClick:"&",onDoubleClick:"&"},controller:["$scope","$element","$attrs","$filter",function(a,c,g,e){a.ctrlKey=!1;a.shiftKey=!1;a.selection={};a.prevRow=null;a.sortCol=
null;a.sortReverse=!1;a.selectRow=function(b){a.ctrlKey||a.shiftKey||(a.selection={});if(a.ctrlKey)a.selection[this.row.$$hashKey]=a.selection[this.row.$$hashKey]?!1:!0;else if(a.shiftKey){if(a.prevRow)for(min=Math.min(this.$index,a.prevRow.$index),max=Math.max(this.$index,a.prevRow.$index),this.$index>a.prevRow.$index?min++:max--,b=min;b<=max;b++)a.selection[a.dataprovider[b].$$hashKey]=a.selection[a.dataprovider[b].$$hashKey]?!1:!0}else a.selection[this.row.$$hashKey]=!0;a.prevRow=this;var c=[],
d=a.dataprovider.length;for(b=0;b<d;b++)a.selection[a.dataprovider[b].$$hashKey]&&c.push(a.dataprovider[b]);a.$emit("gridSelectionChanged",c)};a.resetSort=function(){null!=a.sortCol&&(a.dataprovider=e("orderBy")(a.dataprovider,this.sortCol,a.sortReverse))};a.sortColumn=function(){a.sortReverse=a.sortCol==this.col.value?!a.sortReverse:!1;a.sortCol=this.col.value;this.col.hasOwnProperty("sortFunction")?a.dataprovider=e("orderBy")(a.dataprovider,this.col.sortFunction,a.sortReverse):"undefined"==typeof a.sortFunction&&
(a.dataprovider=e("orderBy")(a.dataprovider,this.col.value,a.sortReverse))}}],compile:function(){return{pre:function(a,f,g){a.$watch("columndef",function(b){if(b&&0<b.length)if(a.autoWidth)for(var c=Math.floor(99/b.length),d=0;d<b.length;d++)e(".fur-col-"+b[d].value).css("width",+c+"%");else for(d=0;d<b.length;d++)e(".fur-col-"+b[d].value).css("width",null)},!0);a.$watch("columns",function(b){var c=[];if(e.isArray(b))for(var d=0;d<b.length;d++)"string"==typeof b[d]?c.push({label:b[d],value:b[d]}):
c.push(b[d]);a.autoWidth=!1;a.columndef=c},!0);a.$watch("dataprovider",function(b){if(b&&0<b.length&&0==a.columndef.length){var c=[],d;for(d in b[0])c.push({label:d,value:d});a.autoWidth=!0;a.columndef=c}a.resetSort()},!0);var k=function(b){if("keydown"==b.type){if(b.ctrlKey||b.metaKey)a.ctrlKey=!0;b.shiftKey&&(a.shiftKey=!0)}else a.ctrlKey=!1,a.shiftKey=!1};e("body").on("keydown keyup",k);a.$on("$destroy",function(){e("body").off("keydown keyup",k)});g=h.get("ng-fur-grid.html");g=c(g)(a);f.append(g)}}}}}]);
k.module("ngfur.grid",["ngfur.grid.directives"]).run(["$templateCache",function(c){c.put("ng-fur-grid-row.html",'<li ng-repeat="row in dataprovider" class="fur-row clearfix" ng-class="{\'fur-selected\': selection[row.$$hashKey] == true}" ng-click="selectRow()" data-rowid="{{$id}}">\t<div class="fur-cell fur-col-{{col.value}}" ng-repeat="col in columndef" data-rowindex="{{$parent.$index}}" data-colindex="{{$index}}" fur-grid-row-cell></div></li>');c.put("ng-fur-grid-header.html",'<div class="fur-headercell fur-col-{{col.value}}" ng-repeat="col in columndef" data-index="{{$index}}" ng-click="sortColumn()" fur-grid-header-cell></div>');
c.put("ng-fur-grid.html",'<div class="fur-grid"><div class="fur-header clearfix" fur-grid-header></div><ul class="fur-rows" fur-grid-rows></ul></div>')}])})(angular,jQuery);